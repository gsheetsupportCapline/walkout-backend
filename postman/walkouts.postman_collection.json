{
  "info": {
    "_postman_id": "walkouts-001",
    "name": "Walkouts",
    "description": "Walkout form management endpoints - submit, update, get, list, and delete operations with formRefId support",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "Submit Office Section",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "if (pm.response.code === 201) {",
              "    const response = pm.response.json();",
              "    if (response.data && response.data._id) {",
              "        pm.collectionVariables.set('walkout_id', response.data._id);",
              "        pm.environment.set('walkout_id', response.data._id);",
              "        console.log('✓ Walkout ID automatically saved');",
              "    }",
              "}"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "auth": {
          "type": "bearer",
          "bearer": [
            {
              "key": "token",
              "value": "{{auth_token}}",
              "type": "string"
            }
          ]
        },
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"formRefId\": \"FORM-2026-001\",\n  \"officeSection\": {\n    \"officeName\": \"Main Office\",\n    \"dos\": \"2026-01-15\",\n    \"patientName\": \"John Doe\",\n    \"patientCame\": \"yes\",\n    \"postOpZeroProduction\": \"no\",\n    \"appointmentType\": \"New Patient\",\n    \"provider\": \"Dr. Smith\",\n    \"providerProductionAmount\": 500,\n    \"additionalProvider\": \"Dr. Jones\",\n    \"additionalProviderProductionAmount\": 200,\n    \"secondAdditionalProvider\": \"\",\n    \"secondAdditionalProviderProductionAmount\": 0,\n    \"hygienist\": \"Sarah Williams\",\n    \"hygienistProductionAmount\": 150,\n    \"additionalHygienist\": \"\",\n    \"additionalHygienistProductionAmount\": 0,\n    \"officeCollectionsRadio\": \"yes\",\n    \"officeCollectionsAmount\": 850,\n    \"paymentModeRadio\": \"cash\",\n    \"cashAmount\": 850,\n    \"creditCardAmount\": 0,\n    \"checkAmount\": 0,\n    \"financingAmount\": 0,\n    \"otherAmount\": 0,\n    \"otherPaymentMode\": \"\",\n    \"thirdPartyAmount\": 0,\n    \"thirdPartyCompanyName\": \"\",\n    \"otherCredit\": 0,\n    \"insurancePaymentsRadio\": \"no\",\n    \"expectedPatientPortionOfficeWO\": 0,\n    \"insuranceCompany\": \"\",\n    \"insuranceCompany1\": \"\",\n    \"insuranceCompany2\": \"\",\n    \"insuranceCompanyAmount\": 0,\n    \"insuranceCompanyAmount1\": 0,\n    \"insuranceCompanyAmount2\": 0\n  }\n}"
        },
        "url": {
          "raw": "{{base_url}}/api/walkouts/submit-office",
          "host": ["{{base_url}}"],
          "path": ["api", "walkouts", "submit-office"]
        },
        "description": "Submit office section of walkout form. formRefId is optional but recommended for linking frontend form to walkout entry."
      },
      "response": []
    },
    {
      "name": "Get All Walkouts",
      "request": {
        "auth": {
          "type": "bearer",
          "bearer": [
            {
              "key": "token",
              "value": "{{auth_token}}",
              "type": "string"
            }
          ]
        },
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{base_url}}/api/walkouts?page=1&limit=20&formRefId=FORM-2026-001&officeName=Main Office&dos=2026-01-15",
          "host": ["{{base_url}}"],
          "path": ["api", "walkouts"],
          "query": [
            {
              "key": "page",
              "value": "1",
              "description": "Page number for pagination"
            },
            {
              "key": "limit",
              "value": "20",
              "description": "Number of items per page"
            },
            {
              "key": "formRefId",
              "value": "FORM-2026-001",
              "description": "Filter by form reference ID"
            },
            {
              "key": "officeName",
              "value": "Main Office",
              "description": "Filter by office name"
            },
            {
              "key": "dos",
              "value": "2026-01-15",
              "description": "Filter by date of service"
            }
          ]
        },
        "description": "Get all walkouts with optional filters: formRefId, officeName, dos. Supports pagination with page and limit query params."
      },
      "response": []
    },
    {
      "name": "Get Walkout by ID",
      "request": {
        "auth": {
          "type": "bearer",
          "bearer": [
            {
              "key": "token",
              "value": "{{auth_token}}",
              "type": "string"
            }
          ]
        },
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{base_url}}/api/walkouts/{{walkout_id}}",
          "host": ["{{base_url}}"],
          "path": ["api", "walkouts", "{{walkout_id}}"]
        },
        "description": "Get walkout details by ID"
      },
      "response": []
    },
    {
      "name": "Update Office Section",
      "request": {
        "auth": {
          "type": "bearer",
          "bearer": [
            {
              "key": "token",
              "value": "{{auth_token}}",
              "type": "string"
            }
          ]
        },
        "method": "PUT",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"officeSection\": {\n    \"officeName\": \"Main Office\",\n    \"dos\": \"2026-01-15\",\n    \"patientName\": \"John Doe Updated\",\n    \"patientCame\": \"yes\",\n    \"postOpZeroProduction\": \"no\",\n    \"appointmentType\": \"Follow Up\",\n    \"provider\": \"Dr. Smith\",\n    \"providerProductionAmount\": 600,\n    \"additionalProvider\": \"Dr. Jones\",\n    \"additionalProviderProductionAmount\": 250,\n    \"secondAdditionalProvider\": \"\",\n    \"secondAdditionalProviderProductionAmount\": 0,\n    \"hygienist\": \"Sarah Williams\",\n    \"hygienistProductionAmount\": 150,\n    \"additionalHygienist\": \"\",\n    \"additionalHygienistProductionAmount\": 0,\n    \"officeCollectionsRadio\": \"yes\",\n    \"officeCollectionsAmount\": 1000,\n    \"paymentModeRadio\": \"credit_card\",\n    \"cashAmount\": 0,\n    \"creditCardAmount\": 1000,\n    \"checkAmount\": 0,\n    \"financingAmount\": 0,\n    \"otherAmount\": 0,\n    \"otherPaymentMode\": \"\",\n    \"thirdPartyAmount\": 0,\n    \"thirdPartyCompanyName\": \"\",\n    \"otherCredit\": 0,\n    \"insurancePaymentsRadio\": \"no\",\n    \"expectedPatientPortionOfficeWO\": 0,\n    \"insuranceCompany\": \"\",\n    \"insuranceCompany1\": \"\",\n    \"insuranceCompany2\": \"\",\n    \"insuranceCompanyAmount\": 0,\n    \"insuranceCompanyAmount1\": 0,\n    \"insuranceCompanyAmount2\": 0\n  }\n}"
        },
        "url": {
          "raw": "{{base_url}}/api/walkouts/{{walkout_id}}/office",
          "host": ["{{base_url}}"],
          "path": ["api", "walkouts", "{{walkout_id}}", "office"]
        },
        "description": "Update office section with complete validation. Includes batch error collection and conditional field saving. formRefId cannot be updated after first submission."
      },
      "response": []
    },
    {
      "name": "Submit LC3 Section",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "if (pm.response.code === 200) {",
              "    console.log('✓ LC3 Section submitted/updated successfully');",
              "}"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "auth": {
          "type": "bearer",
          "bearer": [
            {
              "key": "token",
              "value": "{{auth_token}}",
              "type": "string"
            }
          ]
        },
        "method": "PUT",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"ruleEngine\": {\n    \"fieldsetStatus\": \"complete\",\n    \"didLc3RunRules\": 1,\n    \"ruleEngineUniqueId\": \"RE-2026-12345\",\n    \"reasonForNotRun\": \"\",\n    \"failedRules\": [\n      {\n        \"message\": \"Missing pre-authorization for major service\",\n        \"resolved\": false\n      },\n      {\n        \"message\": \"Patient portion calculation mismatch\",\n        \"resolved\": true\n      }\n    ],\n    \"lastFetchedId\": \"RE-2026-12345\"\n  },\n  \"documentCheck\": {\n    \"fieldsetStatus\": \"complete\",\n    \"signedGeneralConsent\": 1,\n    \"signedTreatmentConsent\": 1,\n    \"preAuthAvailable\": 2,\n    \"signedTxPlan\": 1,\n    \"perioChart\": 3,\n    \"nvd\": 1,\n    \"routeSheet\": 1,\n    \"prcUpdatedInRouteSheet\": 1,\n    \"narrative\": 1\n  },\n  \"attachmentsCheck\": {\n    \"fieldsetStatus\": \"complete\",\n    \"xRayPanoAttached\": 1,\n    \"majorServiceForm\": 2,\n    \"bwPaAttached\": 1,\n    \"fmxAttached\": 3,\n    \"cephAttached\": 3\n  },\n  \"patientPortionCheck\": {\n    \"fieldsetStatus\": \"complete\",\n    \"expectedPPInLC3\": 250.50,\n    \"differenceInPPWalkoutVsLC3\": 10.50,\n    \"isPPVerified\": 1,\n    \"isPPUpdatedInLC3\": 1\n  },\n  \"productionDetails\": {\n    \"fieldsetStatus\": \"complete\",\n    \"productionInLC3\": 850.00,\n    \"differenceInProdWalkoutVsLC3\": 0,\n    \"didLc3TakeApproval\": 2,\n    \"reasonsToHold\": [1, 3, 5],\n    \"wasWalkoutHoldInLC3\": 2,\n    \"wasEligibilityWrong\": 2,\n    \"wereAllNotesReadable\": 1,\n    \"wereExtensionsHandledCorrectly\": 1\n  },\n  \"providerNotes\": {\n    \"fieldsetStatus\": \"complete\",\n    \"isNoteValidated\": 1,\n    \"numberOfElements\": 4,\n    \"providerNote\": \"Patient responded well to treatment. Follow-up in 2 weeks.\",\n    \"hygienistNote\": \"Oral hygiene improved since last visit. Continue current routine.\"\n  },\n  \"lc3Remarks\": \"All documents verified and processed. Ready for audit.\",\n  \"onHoldNote\": \"Waiting for insurance pre-authorization confirmation.\"\n}"
        },
        "url": {
          "raw": "{{base_url}}/api/walkouts/{{walkout_id}}/lc3",
          "host": ["{{base_url}}"],
          "path": ["api", "walkouts", "{{walkout_id}}", "lc3"]
        },
        "description": "Submit or update LC3 section. All fieldsets are optional and will be merged with existing data. Office section must be submitted first. Use onHoldNote to add a new note to the onHoldNotes array."
      },
      "response": []
    },
    {
      "name": "Delete Walkout",
      "request": {
        "auth": {
          "type": "bearer",
          "bearer": [
            {
              "key": "token",
              "value": "{{auth_token}}",
              "type": "string"
            }
          ]
        },
        "method": "DELETE",
        "header": [],
        "url": {
          "raw": "{{base_url}}/api/walkouts/{{walkout_id}}",
          "host": ["{{base_url}}"],
          "path": ["api", "walkouts", "{{walkout_id}}"]
        },
        "description": "Delete walkout (Admin/SuperAdmin only)"
      },
      "response": []
    }
  ],
  "variable": [
    {
      "key": "walkout_id",
      "value": "",
      "type": "string"
    }
  ]
}
